# HÆ°á»›ng Dáº«n Quáº£n LÃ½ PhÃ­ Váº­n Chuyá»ƒn

## TÃ­nh NÄƒng Má»›i

### 1. Quáº£n LÃ½ PhÃ­ Váº­n Chuyá»ƒn (Admin)

Admin cÃ³ thá»ƒ quáº£n lÃ½ phÃ­ váº­n chuyá»ƒn theo tá»«ng tá»‰nh/thÃ nh phá»‘ táº¡i trang **PhÃ­ Váº­n Chuyá»ƒn**.

#### Chá»©c nÄƒng:

- âœ… ThÃªm phÃ­ váº­n chuyá»ƒn cho tá»«ng tá»‰nh/thÃ nh phá»‘
- âœ… Cáº­p nháº­t phÃ­ vÃ  thá»i gian giao hÃ ng Æ°á»›c tÃ­nh
- âœ… KÃ­ch hoáº¡t/Táº¡m ngÆ°ng phÃ­ váº­n chuyá»ƒn
- âœ… XÃ³a phÃ­ váº­n chuyá»ƒn

#### CÃ¡ch sá»­ dá»¥ng:

1. **ÄÄƒng nháº­p Admin Panel** â†’ VÃ o má»¥c **"PhÃ­ Váº­n Chuyá»ƒn"**

2. **ThÃªm phÃ­ váº­n chuyá»ƒn má»›i:**

   - Click nÃºt **"ThÃªm Khu Vá»±c"**
   - Chá»n **Tá»‰nh/ThÃ nh phá»‘** tá»« danh sÃ¡ch
   - Nháº­p **PhÃ­ váº­n chuyá»ƒn** (VNÄ)
   - Nháº­p **Thá»i gian giao hÃ ng Æ°á»›c tÃ­nh** (vÃ­ dá»¥: "2-3 ngÃ y")
   - Chá»n **KÃ­ch hoáº¡t** Ä‘á»ƒ Ã¡p dá»¥ng ngay
   - Click **"ThÃªm Má»›i"**

3. **Chá»‰nh sá»­a phÃ­ váº­n chuyá»ƒn:**

   - Click nÃºt **"Chá»‰nh sá»­a"** (âœï¸) trÃªn hÃ ng cáº§n sá»­a
   - Cáº­p nháº­t thÃ´ng tin
   - Click **"Cáº­p Nháº­t"**

4. **XÃ³a phÃ­ váº­n chuyá»ƒn:**
   - Click nÃºt **"XÃ³a"** (ğŸ—‘ï¸) trÃªn hÃ ng cáº§n xÃ³a
   - XÃ¡c nháº­n xÃ³a

### 2. TÃ­nh PhÃ­ Váº­n Chuyá»ƒn Tá»± Äá»™ng (Frontend)

KhÃ¡ch hÃ ng sáº½ tháº¥y phÃ­ váº­n chuyá»ƒn tá»± Ä‘á»™ng khi Ä‘iá»n Ä‘á»‹a chá»‰ giao hÃ ng.

#### CÃ¡ch hoáº¡t Ä‘á»™ng:

1. **Trang Thanh ToÃ¡n (Checkout):**

   - KhÃ¡ch hÃ ng Ä‘iá»n **Há» tÃªn**, **Email**, **Sá»‘ Ä‘iá»‡n thoáº¡i**
   - Chá»n **Tá»‰nh/ThÃ nh phá»‘** tá»« dropdown
   - Nháº­p **Quáº­n/Huyá»‡n**, **PhÆ°á»ng/XÃ£** (tÃ¹y chá»n)
   - Nháº­p **Äá»‹a chá»‰ chi tiáº¿t**

2. **Tá»± Ä‘á»™ng hiá»ƒn thá»‹ phÃ­:**

   - Khi chá»n tá»‰nh/thÃ nh phá»‘ â†’ Há»‡ thá»‘ng tá»± Ä‘á»™ng tÃ­nh vÃ  hiá»ƒn thá»‹ phÃ­ váº­n chuyá»ƒn
   - Hiá»ƒn thá»‹ **Thá»i gian giao hÃ ng Æ°á»›c tÃ­nh**
   - Tá»•ng tiá»n Ä‘Æ°á»£c cáº­p nháº­t tá»± Ä‘á»™ng

3. **PhÆ°Æ¡ng thá»©c thanh toÃ¡n má»›i:**

   - ğŸ’µ **COD (Cash on Delivery)** - Thanh toÃ¡n khi nháº­n hÃ ng
   - ğŸ¦ **Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng** - Chuyá»ƒn khoáº£n trá»±c tiáº¿p
   - ğŸ“± **VÃ­ MoMo** - Thanh toÃ¡n qua vÃ­ MoMo
   - ğŸ’³ **VNPay** - Thanh toÃ¡n qua cá»•ng VNPay
   - ğŸ”µ **ZaloPay** - Thanh toÃ¡n qua vÃ­ ZaloPay

4. **ThÃ´ng tin chuyá»ƒn khoáº£n:**
   - Náº¿u chá»n **"Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng"**, há»‡ thá»‘ng hiá»ƒn thá»‹:
     - TÃªn ngÃ¢n hÃ ng
     - Sá»‘ tÃ i khoáº£n
     - Chá»§ tÃ i khoáº£n
     - Ná»™i dung chuyá»ƒn khoáº£n
   - KhÃ¡ch hÃ ng nháº­p **MÃ£ giao dá»‹ch** sau khi chuyá»ƒn khoáº£n

## API Endpoints

### Public APIs (KhÃ´ng cáº§n xÃ¡c thá»±c)

#### 1. Láº¥y danh sÃ¡ch phÃ­ váº­n chuyá»ƒn

```http
GET /api/shipping
```

**Response:**

```json
{
  "success": true,
  "data": [
    {
      "_id": "...",
      "province": "HÃ  Ná»™i",
      "rate": 20000,
      "estimatedDays": "1-2 ngÃ y",
      "isActive": true
    }
  ]
}
```

#### 2. Láº¥y phÃ­ váº­n chuyá»ƒn theo tá»‰nh

```http
GET /api/shipping/:province
```

**Example:**

```http
GET /api/shipping/HÃ  Ná»™i
```

**Response:**

```json
{
  "success": true,
  "data": {
    "rate": 20000,
    "estimatedDays": "1-2 ngÃ y"
  }
}
```

### Admin APIs (Cáº§n xÃ¡c thá»±c Admin)

#### 3. Táº¡o/Cáº­p nháº­t phÃ­ váº­n chuyá»ƒn

```http
POST /api/shipping
Authorization: Bearer {token}
```

**Body:**

```json
{
  "province": "HÃ  Ná»™i",
  "rate": 20000,
  "estimatedDays": "1-2 ngÃ y",
  "isActive": true
}
```

#### 4. Cáº­p nháº­t phÃ­ váº­n chuyá»ƒn

```http
PUT /api/shipping/:id
Authorization: Bearer {token}
```

**Body:**

```json
{
  "province": "HÃ  Ná»™i",
  "rate": 25000,
  "estimatedDays": "1-2 ngÃ y",
  "isActive": true
}
```

#### 5. XÃ³a phÃ­ váº­n chuyá»ƒn

```http
DELETE /api/shipping/:id
Authorization: Bearer {token}
```

## Database Schema

### ShippingRate Model

```javascript
{
  province: String (unique),      // TÃªn tá»‰nh/thÃ nh phá»‘
  rate: Number,                   // PhÃ­ váº­n chuyá»ƒn (VNÄ)
  estimatedDays: String,          // Thá»i gian giao hÃ ng
  isActive: Boolean,              // KÃ­ch hoáº¡t
  createdAt: Date,
  updatedAt: Date
}
```

### Order Model (ÄÃ£ cáº­p nháº­t)

```javascript
{
  customerInfo: {
    fullName: String,
    email: String,
    phone: String,
    address: String,
    city: String,              // Tá»‰nh/ThÃ nh phá»‘ (dropdown)
    district: String,
    ward: String,
    notes: String
  },
  shippingFee: Number,         // PhÃ­ váº­n chuyá»ƒn Ä‘á»™ng
  paymentMethod: String,       // cod, bank_transfer, momo, vnpay, zalopay
  paymentInfo: {               // ThÃ´ng tin thanh toÃ¡n (cho bank_transfer)
    bankName: String,
    accountNumber: String,
    accountName: String,
    transactionId: String
  }
}
```

## Seed Data

ÄÃ£ táº¡o sáºµn **20 phÃ­ váº­n chuyá»ƒn máº«u** cho cÃ¡c tá»‰nh/thÃ nh phá»‘ chÃ­nh:

| Tá»‰nh/ThÃ nh phá»‘ | PhÃ­ váº­n chuyá»ƒn | Thá»i gian |
| -------------- | -------------- | --------- |
| HÃ  Ná»™i         | 20,000 â‚«       | 1-2 ngÃ y  |
| Há»“ ChÃ­ Minh    | 25,000 â‚«       | 2-3 ngÃ y  |
| ÄÃ  Náºµng        | 30,000 â‚«       | 2-3 ngÃ y  |
| Háº£i PhÃ²ng      | 25,000 â‚«       | 1-2 ngÃ y  |
| Cáº§n ThÆ¡        | 35,000 â‚«       | 3-4 ngÃ y  |
| ...            | ...            | ...       |

**Cháº¡y láº¡i seed:**

```bash
cd backend
node seedShippingRates.js
```

## UI/UX Improvements

### Trang Thanh ToÃ¡n (Checkout)

1. **Äá»‹a chá»‰ giao hÃ ng:**

   - Dropdown chá»n tá»‰nh/thÃ nh phá»‘ (63 tá»‰nh Viá»‡t Nam)
   - Input text cho quáº­n/huyá»‡n, phÆ°á»ng/xÃ£
   - Placeholder rÃµ rÃ ng: "Nháº­p quáº­n/huyá»‡n", "Nháº­p phÆ°á»ng/xÃ£"

2. **Hiá»ƒn thá»‹ phÃ­ váº­n chuyá»ƒn:**

   - Box mÃ u xanh ná»•i báº­t
   - Icon ğŸ“¦ ThÃ´ng tin váº­n chuyá»ƒn
   - Hiá»ƒn thá»‹ rÃµ: "PhÃ­ váº­n chuyá»ƒn Ä‘áº¿n [Tá»‰nh]: XX,XXX â‚«"
   - Thá»i gian giao hÃ ng Æ°á»›c tÃ­nh

3. **PhÆ°Æ¡ng thá»©c thanh toÃ¡n:**

   - Design card Ä‘áº¹p vá»›i icon riÃªng
   - MÃ´ táº£ ngáº¯n gá»n cho tá»«ng phÆ°Æ¡ng thá»©c
   - Hover effect tÆ°Æ¡ng tÃ¡c
   - Box thÃ´ng tin chuyá»ƒn khoáº£n (cho bank_transfer)

4. **Summary Order:**
   - Hiá»ƒn thá»‹ phÃ­ váº­n chuyá»ƒn rÃµ rÃ ng
   - Note nhá»: "ğŸšš Giao hÃ ng Ä‘áº¿n [Tá»‰nh] (X-Y ngÃ y)"
   - MÃ u xanh cho shipping fee

## Testing

### Test Admin Panel:

1. ÄÄƒng nháº­p Admin â†’ VÃ o "PhÃ­ Váº­n Chuyá»ƒn"
2. ThÃªm phÃ­ váº­n chuyá»ƒn cho "HÃ  Ná»™i": 20,000 â‚«
3. Kiá»ƒm tra hiá»ƒn thá»‹ trong danh sÃ¡ch
4. Chá»‰nh sá»­a thÃ nh 25,000 â‚«
5. XÃ³a vÃ  kiá»ƒm tra

### Test Frontend:

1. VÃ o trang Products â†’ ThÃªm sáº£n pháº©m vÃ o giá»
2. ÄÄƒng nháº­p user â†’ VÃ o Checkout
3. Chá»n tá»‰nh "HÃ  Ná»™i" â†’ Kiá»ƒm tra phÃ­ 20,000 â‚« hiá»ƒn thá»‹
4. Chá»n tá»‰nh "Há»“ ChÃ­ Minh" â†’ Kiá»ƒm tra phÃ­ thay Ä‘á»•i thÃ nh 25,000 â‚«
5. Chá»n phÆ°Æ¡ng thá»©c "Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng" â†’ Kiá»ƒm tra hiá»ƒn thá»‹ thÃ´ng tin
6. Äáº·t hÃ ng vÃ  kiá»ƒm tra Order

## Notes

- âš ï¸ **PhÃ­ máº·c Ä‘á»‹nh:** Náº¿u tá»‰nh chÆ°a cÃ³ trong database, há»‡ thá»‘ng dÃ¹ng phÃ­ máº·c Ä‘á»‹nh 30,000 â‚«
- ğŸ’¡ **Free shipping:** Admin cÃ³ thá»ƒ set phÃ­ = 0 cho tá»‰nh nÃ o Ä‘Ã³ Ä‘á»ƒ miá»…n phÃ­ ship
- ğŸ”’ **Báº£o máº­t:** Chá»‰ Admin má»›i Ä‘Æ°á»£c thÃªm/sá»­a/xÃ³a phÃ­ váº­n chuyá»ƒn
- ğŸ“± **Responsive:** UI hoÃ n toÃ n tÆ°Æ¡ng thÃ­ch mobile

## Support

Náº¿u cÃ³ váº¥n Ä‘á», kiá»ƒm tra:

1. Backend server Ä‘ang cháº¡y: `http://localhost:5000/api/health`
2. MongoDB Ä‘Ã£ connect thÃ nh cÃ´ng
3. ÄÃ£ seed shipping rates: `node seedShippingRates.js`
4. Token admin cÃ²n háº¡n (7 ngÃ y)
